<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/x-icon"
        href="data:image/x-icon;base64,data:image/png;base64,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">

    <link rel="manifest" href="manifest.json" crossorigin="use-credentials" />
    <title>TERMOx</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="flex flex-col items-center justify-center min-h-screen bg-gray-100 p-4">
    <h1 class="text-4xl font-bold text-gray-900 mb-4">TERMOx</h1>
    <nav class="mb-6 space-x-4">
        <a href="/" class="text-blue-500 hover:underline">Termo</a>
        <a href="/?q=2" class="text-blue-500 hover:underline">Dueto</a>
        <a href="/?q=4" class="text-blue-500 hover:underline">Quarteto</a>
    </nav>

    <div class="grid grid-rows-6 gap-2 mb-4" id="game-grid">
        <script>
            for (let row = 0; row < 6; row++) {
                document.write('<div class="grid grid-cols-5 gap-2" data-row="' + row + '">');
                for (let col = 0; col < 5; col++) {
                    const disabledClass = row === 0 ? "" : "bg-gray-200 opacity-50";
                    document.write(`
                        <input maxlength='1' onkeydown='return /[a-z]/i.test(event.key)' class="w-12 h-12 border-2 border-gray-300 text-center flex items-center justify-center text-2xl font-bold uppercase caret-transparent focus:outline-none focus:border-4 focus:border-cyan-300 ${disabledClass}" 
                            data-row="${row}" data-col="${col}">
                        </input>
                    `);
                }
                document.write('</div>');
            }
        </script>
    </div>


    <div class="grid grid-cols-10 gap-2 max-w-md">
        <script>
            const keys = "QWERTYUIOPASDFGHJKLZXCVBNM";
            for (const key of keys) {
                document.write(`<button class="p-2 w-10 h-10 bg-gray-300 text-gray-900 rounded font-bold">${key}</button>`);
            }
        </script>
    </div>

    <div class="mt-6 p-4 bg-white shadow-lg rounded-lg">
        <label class="flex items-center space-x-2">
            <input type="radio" name="cheats" value="off" class="w-4 h-4" checked>
            <span>Normal Mode</span>
        </label>
        <label class="flex items-center space-x-2 mt-2">
            <input type="radio" name="cheats" value="infinite" class="w-4 h-4">
            <span>Infinite Lives</span>
        </label>
    </div>

</body>

<script>
    let wordSet = new Set()

    fetch("./wordlist").then(res => res.text())
        .then(data => {
            wordSet = new Set(data.split("\n").map(word => word.trim().toUpperCase()));
        });

    const isValidWord = (word) => wordSet.has(word.toUpperCase());

    const params = new URLSearchParams(window.location.search);
    const q = params.get("q") ?? 1;

    async function fetchWord() {
        const res = await fetch("/word")
        const word = await res.text()
        return word
    }

    let chosen = [];

    async function startGame() {
        for (let i = 0; i < q; i++) {
            chosen.push(await fetchWord());
        }
    }

    document.addEventListener("DOMContentLoaded", () => {
        document.querySelectorAll("input").forEach(input => input.value = "");

        let currentRow = 0;
        let inputs = document.querySelectorAll(`[data-row="${currentRow}"] input`);
        inputs[0].focus();

        document.querySelectorAll("input").forEach((input) => {
            input.addEventListener("input", (e) => {
                const value = e.target.value.toUpperCase();
                e.target.value = value;

                if (value && e.target.dataset.col < 4) {
                    const nextInput = document.querySelector(`[data-row="${currentRow}"][data-col="${parseInt(e.target.dataset.col) + 1}"]`);
                    if (nextInput) nextInput.focus();
                }
            });

            input.addEventListener("keydown", (e) => {
                if (e.key === "Enter") {
                    if (e.target.value === "") return
                    const letter = document.querySelector(`[data-row="${currentRow}"][data-col="${parseInt(e.target.dataset.col)}"]`)
                    const word = Array.from(letter.parentElement.querySelectorAll("input")).map(l => l.value.trim()).join("")
                    console.log("got: ", isValidWord(word))
                    console.log("chosen: ", chosen)
                }

                if (e.key === "Backspace") {
                    if (e.target.value === "" && e.target.dataset.col > 0) {
                        const prevInput = document.querySelector(`[data-row="${currentRow}"][data-col="${parseInt(e.target.dataset.col) - 1}"]`);
                        if (prevInput) prevInput.focus();
                    }
                }
            });
        });
    });

    startGame()
</script>

</html>
